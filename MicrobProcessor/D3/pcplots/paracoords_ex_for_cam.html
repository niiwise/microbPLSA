<!doctype html>
<title>Phylum abundance across ocean depth</title>
<link rel="stylesheet" type="text/css" href="d3.parcoords.css">
<link rel="stylesheet" type="text/css" href="style.css">
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="d3.parcoords.js"></script>
<body>
<p> Here is an example of a parallel coordinates plot. <p>
<div id="plot" class="parcoords" style="width:1800px;height:300px;"></div>
<p>An example of a topic distribution for microbial samples on a parallel coordinates plot
with enabled brushing. 
<p><button id="btnReset">Reset Brushes</button>
<script>

var otus = [
{phylum:"Actinobacteria", 	d10m: 0.10, d20m: 0.20, d50m: 0.30, d70m: 0.50, d100m: 0.55},
{phylum:"Firmicutes", 		d10m: 0.00, d20m: 0.00, d50m: 0.10, d70m: 0.20, d100m: 0.45},
{phylum:"Firmicutes", 		d10m: 0.00, d20m: 0.20, d50m: 0.23, d70m: 0.25, d100m: 0.35},
{phylum:"Proteobacteria",	d10m: 0.00, d20m: 0.20, d50m: 0.30, d70m: 0.30, d100m: 0.0},
{phylum:"Verrucomicrobia", 	d10m: 0.20, d20m: 0.20, d50m: 0.05, d70m: 0.0, d100m: 0.0},
{phylum:"Nitrospirae", 		d10m: 0.25, d20m: 0.20, d50m: 0.00, d70m: 0.00, d100m: 0.05},
{phylum:"Firmicutes", 		d10m: 0.00, d20m: 0.20, d50m: 0.23, d70m: 0.25, d100m: 0.35},
{phylum:"Proteobacteria",	d10m: 0.00, d20m: 0.20, d50m: 0.20, d70m: 0.30, d100m: 0.10},
{phylum:"Verrucomicrobia", 	d10m: 0.20, d20m: 0.20, d50m: 0.05, d70m: 0.0, d100m: 0.09},
{phylum:"Nitrospirae", 		d10m: 0.20, d20m: 0.10, d50m: 0.00, d70m: 0.30, d100m: 0.15},
{phylum:"Firmicutes", 		d10m: 0.0, d20m: 0.20, d50m: 0.23, d70m: 0.25, d100m: 0.35},
{phylum:"Proteobacteria",	d10m: 0.00, d20m: 0.10, d50m: 0.30, d70m: 0.30, d100m: 0.0},
{phylum:"Verrucomicrobia", 	d10m: 0.05, d20m: 0.10, d50m: 0.05, d70m: 0.0, d100m: 0.10},
{phylum:"Nitrospirae", 		d10m: 0.06, d20m: 0.00, d50m: 0.10, d70m: 0.05, d100m: 0.35},
];

var dim = ['phylum','"d10m"','"d20m"','"d50m"','"d70m"','"d100m"'];
var types = {'phylum': 'string',"d10m": 'string',"d20m": 'string',"d50m": 'string',"d70m": 'string',"d100m": 'string'}


//color scale used to color samples of same type
var colors = d3.scale.category10()
	.domain(0, d3.set(otus, function(d) {return d.phylum}).length)

var parcoords = d3.parcoords()("#plot")
    .color(function(d) { return colors(d.phylum); })
    .types(types)
//    .dimensions(dim)
    .alpha(0.4)
    .height(300)
    .width(1800)
    .margin({
    	bottom: 12,
		left: 30,
		right: 30,
		top: 24
	})

parcoords.data(otus)
    .render()
    .reorderable()
    .shadows()	
    .brushable();  // enable brushing

console.log(parcoords.state)

context = parcoords.ctx

console.log(context)
context.font = "5px Arial";
context.fillStyle = "#000099";

var canvas = document.getElementById("plot");
var img  = canvas.toDataURL("image/png");
document.write('<img src="'+img+'"/>');

d3.select('#btnReset').on('click', function() {parcoords.brushReset();})
</script>



